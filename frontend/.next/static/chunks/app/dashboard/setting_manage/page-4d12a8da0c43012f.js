(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{12379:(e,r,s)=>{"use strict";s.d(r,{default:()=>h});var t=s(95155),a=s(30285),n=s(75937),i=s(62523),o=s(66695),d=s(12115),l=s(62177),c=s(68309),u=s(90221);let m=c.Ik({email:c.Yj().min(1,"กรุณากรอกอีเมล").email({message:"อีเมลไม่ถูกต้อง"}),username:c.Yj().min(1,"กรุณากรอกชื่อผู้ใช้งาน"),phone:c.Yj().min(1,"กรุณากรอกหมายเลขโทรศัพท์")}),x=c.Ik({currentPassword:c.Yj().min(1,"กรุณากรอกรหัสผ่านปัจจุบัน"),newPassword:c.Yj().min(6,"รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร"),confirmPassword:c.Yj().min(1,"กรุณายืนยันรหัสผ่าน")}).refine(e=>e.newPassword===e.confirmPassword,{message:"รหัสผ่านไม่ตรงกันกรุณากรอกใหม่อีกครั้ง",path:["confirmPassword"]}),h=function(){let[e,r]=(0,d.useState)(!1),[s,c]=(0,d.useState)(!1),[h,p]=(0,d.useState)(!0),[f,b]=(0,d.useState)(""),[g,j]=(0,d.useState)(""),v=async()=>{try{let e=await fetch("/api/admin/profile",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),r=await e.json();if(r.success)return r.data;return console.error("Error fetching admin data:",r.error),null}catch(e){return console.error("Error fetching admin data:",e),null}},w=(0,l.mN)({resolver:(0,u.u)(m),defaultValues:{email:"",username:"",phone:""}});(0,d.useEffect)(()=>{(async()=>{p(!0);let e=await v();e&&w.reset({email:e.email||"",username:e.username||"",phone:e.phone||""}),p(!1)})()},[w]);let N=(0,l.mN)({resolver:(0,u.u)(x),defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}});async function y(e){r(!0),b("");try{let r=await fetch("/api/admin/profile",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await r.json();s.success?b("Profile updated successfully!"):b("Error: ".concat(s.error))}catch(e){b("An error occurred while updating profile"),console.error("Error updating profile:",e)}finally{r(!1)}}async function P(e){c(!0),j("");try{let r=await fetch("/api/admin/password",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:e.currentPassword,newPassword:e.newPassword})}),s=await r.json();s.success?(j("Password changed successfully!"),N.reset()):j("Error: ".concat(s.error))}catch(e){j("An error occurred while changing password"),console.error("Error changing password:",e)}finally{c(!1)}}return h?(0,t.jsx)("div",{className:"container mx-auto p-6 max-w-6xl",children:(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)("div",{className:"text-lg",children:"Loading admin data..."})})}):(0,t.jsx)("div",{className:"container mx-auto p-6 max-w-4xl",children:(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)(o.Zp,{children:[(0,t.jsx)(o.aR,{children:(0,t.jsx)(o.ZB,{className:"text-2xl font-semibold",children:"Profile Information"})}),(0,t.jsxs)(o.Wu,{children:[f&&(0,t.jsx)("div",{className:"mb-4 p-4 rounded-md ".concat(f.includes("Error")?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"),children:f}),(0,t.jsx)(n.lV,{...w,children:(0,t.jsxs)("form",{onSubmit:w.handleSubmit(y),className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsx)(n.zB,{control:w.control,name:"username",render:e=>{let{field:r}=e;return(0,t.jsxs)(n.eI,{children:[(0,t.jsx)(n.lR,{className:"text-base font-medium",children:"Username"}),(0,t.jsx)(n.MJ,{children:(0,t.jsx)(i.p,{placeholder:"ชื่อผู้ใช้งาน",...r,className:"h-14 text-base"})}),(0,t.jsx)(n.C5,{})]})}}),(0,t.jsx)(n.zB,{control:w.control,name:"email",render:e=>{let{field:r}=e;return(0,t.jsxs)(n.eI,{children:[(0,t.jsx)(n.lR,{className:"text-base font-medium",children:"Email"}),(0,t.jsx)(n.MJ,{children:(0,t.jsx)(i.p,{type:"email",placeholder:"อีเมล",...r,className:"h-14 text-base"})}),(0,t.jsx)(n.C5,{})]})}})]}),(0,t.jsx)(n.zB,{control:w.control,name:"phone",render:e=>{let{field:r}=e;return(0,t.jsxs)(n.eI,{children:[(0,t.jsx)(n.lR,{className:"text-base font-medium",children:"Phone Number"}),(0,t.jsx)(n.MJ,{children:(0,t.jsx)(i.p,{placeholder:"หมายเลขโทรศัพท์",...r,className:"h-14 text-base"})}),(0,t.jsx)(n.C5,{})]})}}),(0,t.jsx)("div",{className:"pt-6",children:(0,t.jsx)(a.$,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white h-14 text-base font-medium",disabled:e,children:e?"Updating...":"Update Profile"})})]})})]})]}),(0,t.jsxs)(o.Zp,{children:[(0,t.jsx)(o.aR,{children:(0,t.jsx)(o.ZB,{className:"text-2xl font-semibold",children:"Change Password"})}),(0,t.jsxs)(o.Wu,{children:[g&&(0,t.jsx)("div",{className:"mb-4 p-4 rounded-md ".concat(g.includes("Error")?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"),children:g}),(0,t.jsx)(n.lV,{...N,children:(0,t.jsxs)("form",{onSubmit:N.handleSubmit(P),className:"space-y-8",children:[(0,t.jsx)(n.zB,{control:N.control,name:"currentPassword",render:e=>{let{field:r}=e;return(0,t.jsxs)(n.eI,{children:[(0,t.jsx)(n.lR,{className:"text-base font-medium",children:"Current Password"}),(0,t.jsx)(n.MJ,{children:(0,t.jsx)(i.p,{type:"password",placeholder:"รหัสผ่านปัจจุบัน",...r,className:"h-14 text-base"})}),(0,t.jsx)(n.C5,{})]})}}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsx)(n.zB,{control:N.control,name:"newPassword",render:e=>{let{field:r}=e;return(0,t.jsxs)(n.eI,{children:[(0,t.jsx)(n.lR,{className:"text-base font-medium",children:"New Password"}),(0,t.jsx)(n.MJ,{children:(0,t.jsx)(i.p,{type:"password",placeholder:"รหัสผ่านใหม่",...r,className:"h-14 text-base"})}),(0,t.jsx)(n.C5,{})]})}}),(0,t.jsx)(n.zB,{control:N.control,name:"confirmPassword",render:e=>{let{field:r}=e;return(0,t.jsxs)(n.eI,{children:[(0,t.jsx)(n.lR,{className:"text-base font-medium",children:"Confirm Password"}),(0,t.jsx)(n.MJ,{children:(0,t.jsx)(i.p,{type:"password",placeholder:"ยืนยันรหัสผ่านใหม่",...r,className:"h-14 text-base"})}),(0,t.jsx)(n.C5,{})]})}})]}),(0,t.jsx)("div",{className:"pt-6",children:(0,t.jsx)(a.$,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white h-14 text-base font-medium",disabled:s,children:s?"Changing...":"Change Password"})})]})})]})]})]})})}},30285:(e,r,s)=>{"use strict";s.d(r,{$:()=>d,r:()=>o});var t=s(95155);s(12115);var a=s(99708),n=s(74466),i=s(59434);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:r,variant:s,size:n,asChild:d=!1,...l}=e,c=d?a.DX:"button";return(0,t.jsx)(c,{"data-slot":"button",className:(0,i.cn)(o({variant:s,size:n,className:r})),...l})}},36866:(e,r,s)=>{Promise.resolve().then(s.bind(s,12379))},59434:(e,r,s)=>{"use strict";s.d(r,{cn:()=>n});var t=s(52596),a=s(39688);function n(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return(0,a.QP)((0,t.$)(r))}},62523:(e,r,s)=>{"use strict";s.d(r,{p:()=>n});var t=s(95155);s(12115);var a=s(59434);function n(e){let{className:r,type:s,...n}=e;return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...n})}},66695:(e,r,s)=>{"use strict";s.d(r,{BT:()=>d,Wu:()=>l,ZB:()=>o,Zp:()=>n,aR:()=>i});var t=s(95155);s(12115);var a=s(59434);function n(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...s})}function i(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...s})}function o(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",r),...s})}function d(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",r),...s})}function l(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",r),...s})}},75937:(e,r,s)=>{"use strict";s.d(r,{lV:()=>c,MJ:()=>b,zB:()=>m,eI:()=>p,lR:()=>f,C5:()=>g});var t=s(95155),a=s(12115),n=s(99708),i=s(62177),o=s(59434),d=s(40968);function l(e){let{className:r,...s}=e;return(0,t.jsx)(d.b,{"data-slot":"label",className:(0,o.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...s})}let c=i.Op,u=a.createContext({}),m=e=>{let{...r}=e;return(0,t.jsx)(u.Provider,{value:{name:r.name},children:(0,t.jsx)(i.xI,{...r})})},x=()=>{let e=a.useContext(u),r=a.useContext(h),{getFieldState:s}=(0,i.xW)(),t=(0,i.lN)({name:e.name}),n=s(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=r;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...n}},h=a.createContext({});function p(e){let{className:r,...s}=e,n=a.useId();return(0,t.jsx)(h.Provider,{value:{id:n},children:(0,t.jsx)("div",{"data-slot":"form-item",className:(0,o.cn)("grid gap-2",r),...s})})}function f(e){let{className:r,...s}=e,{error:a,formItemId:n}=x();return(0,t.jsx)(l,{"data-slot":"form-label","data-error":!!a,className:(0,o.cn)("data-[error=true]:text-destructive",r),htmlFor:n,...s})}function b(e){let{...r}=e,{error:s,formItemId:a,formDescriptionId:i,formMessageId:o}=x();return(0,t.jsx)(n.DX,{"data-slot":"form-control",id:a,"aria-describedby":s?"".concat(i," ").concat(o):"".concat(i),"aria-invalid":!!s,...r})}function g(e){var r;let{className:s,...a}=e,{error:n,formMessageId:i}=x(),d=n?String(null!=(r=null==n?void 0:n.message)?r:""):a.children;return d?(0,t.jsx)("p",{"data-slot":"form-message",id:i,className:(0,o.cn)("text-destructive text-sm",s),...a,children:d}):null}}},e=>{e.O(0,[389,804,441,964,358],()=>e(e.s=36866)),_N_E=e.O()}]);