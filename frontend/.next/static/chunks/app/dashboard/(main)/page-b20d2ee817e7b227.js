(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[886],{7058:(e,t,s)=>{Promise.resolve().then(s.bind(s,68922))},26126:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(95155);s(12115);var r=s(99708),n=s(74466),l=s(59434);let d=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,asChild:n=!1,...i}=e,o=n?r.DX:"span";return(0,a.jsx)(o,{"data-slot":"badge",className:(0,l.cn)(d({variant:s}),t),...i})}},30285:(e,t,s)=>{"use strict";s.d(t,{$:()=>i,r:()=>d});var a=s(95155);s(12115);var r=s(99708),n=s(74466),l=s(59434);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function i(e){let{className:t,variant:s,size:n,asChild:i=!1,...o}=e,c=i?r.DX:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,l.cn)(d({variant:s,size:n,className:t})),...o})}},54165:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>h,HM:()=>c,L3:()=>p,c7:()=>u,lG:()=>d,zM:()=>i});var a=s(95155);s(12115);var r=s(15452),n=s(54416),l=s(59434);function d(e){let{...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"dialog",...t})}function i(e){let{...t}=e;return(0,a.jsx)(r.l9,{"data-slot":"dialog-trigger",...t})}function o(e){let{...t}=e;return(0,a.jsx)(r.ZL,{"data-slot":"dialog-portal",...t})}function c(e){let{...t}=e;return(0,a.jsx)(r.bm,{"data-slot":"dialog-close",...t})}function x(e){let{className:t,...s}=e;return(0,a.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function m(e){let{className:t,children:s,showCloseButton:d=!0,...i}=e;return(0,a.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,a.jsx)(x,{}),(0,a.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,l.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...i,children:[s,d&&(0,a.jsxs)(r.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(n.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function u(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,l.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function h(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,l.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,l.cn)("text-lg leading-none font-semibold",t),...s})}},59409:(e,t,s)=>{"use strict";s.d(t,{bq:()=>x,eb:()=>u,gC:()=>m,l6:()=>o,yv:()=>c});var a=s(95155);s(12115);var r=s(50083),n=s(66474),l=s(5196),d=s(47863),i=s(59434);function o(e){let{...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,a.jsx)(r.WT,{"data-slot":"select-value",...t})}function x(e){let{className:t,size:s="default",children:l,...d}=e;return(0,a.jsxs)(r.l9,{"data-slot":"select-trigger","data-size":s,className:(0,i.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...d,children:[l,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"size-4 opacity-50"})})]})}function m(e){let{className:t,children:s,position:n="popper",...l}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{"data-slot":"select-content",className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,a.jsx)(h,{}),(0,a.jsx)(r.LM,{className:(0,i.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(p,{})]})})}function u(e){let{className:t,children:s,...n}=e;return(0,a.jsxs)(r.q7,{"data-slot":"select-item",className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...n,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(l.A,{className:"size-4"})})}),(0,a.jsx)(r.p4,{children:s})]})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(r.PP,{"data-slot":"select-scroll-up-button",className:(0,i.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(d.A,{className:"size-4"})})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(r.wn,{"data-slot":"select-scroll-down-button",className:(0,i.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(n.A,{className:"size-4"})})}},59434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var a=s(52596),r=s(39688);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},62523:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(95155);s(12115);var r=s(59434);function n(e){let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},66695:(e,t,s)=>{"use strict";s.d(t,{BT:()=>i,Wu:()=>o,ZB:()=>d,Zp:()=>n,aR:()=>l});var a=s(95155);s(12115);var r=s(59434);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...s})}},68922:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ex});var a=s(95155),r=s(12115),n=s(50802),l=s(66695),d=s(26126),i=s(59409),o=s(61900),c=s(94754),x=s(96025),m=s(17398),u=s(83540),h=s(94517),p=s(24026),f=s(59434);let g={light:"",dark:".dark"},j=r.createContext(null);function v(e){let{id:t,className:s,children:n,config:l,...d}=e,i=r.useId(),o="chart-".concat(t||i.replace(/:/g,""));return(0,a.jsx)(j.Provider,{value:{config:l},children:(0,a.jsxs)("div",{"data-slot":"chart","data-chart":o,className:(0,f.cn)("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",s),...d,children:[(0,a.jsx)(b,{id:o,config:l}),(0,a.jsx)(u.u,{children:n})]})})}let b=e=>{let{id:t,config:s}=e,r=Object.entries(s).filter(e=>{let[,t]=e;return t.theme||t.color});return r.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(g).map(e=>{let[s,a]=e;return"\n".concat(a," [data-chart=").concat(t,"] {\n").concat(r.map(e=>{var t;let[a,r]=e,n=(null==(t=r.theme)?void 0:t[s])||r.color;return n?"  --color-".concat(a,": ").concat(n,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},N=h.m;function w(e){let{active:t,payload:s,className:r,indicator:n="dot",...l}=e;return(0,a.jsx)("div",{})}let y=p.s;function k(e){let{className:t,hideIcon:s=!1,payload:r,...n}=e;return(0,a.jsx)("div",{})}var C=s(17580),A=s(69074),_=s(51154);let S={approved:{label:"อนุมัติ",color:"hsl(142, 76%, 36%)"},rejected:{label:"ปฏิเสธ",color:"hsl(0, 84%, 60%)"}};function z(){let[e,t]=(0,r.useState)("week"),[s,n]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[p,f]=(0,r.useState)(null),[g,j]=(0,r.useState)(!1),b={Sunday:"อาทิตย์",Monday:"จันทร์",Tuesday:"อังคาร",Wednesday:"พุธ",Thursday:"พฤหัสบดี",Friday:"ศุกร์",Saturday:"เสาร์"},z={January:"ม.ค.",February:"ก.พ.",March:"มี.ค.",April:"เม.ย.",May:"พ.ค.",June:"มิ.ย.",July:"ก.ค.",August:"ส.ค.",September:"ก.ย.",October:"ต.ค.",November:"พ.ย.",December:"ธ.ค."},T=(0,r.useCallback)(async e=>{h(!0),f(null);try{let t="";switch(e){case"week":default:t="/api/visitor-record-weekly";break;case"month":t="/api/visitor-record-monthly";break;case"year":t="/api/visitor-record-yearly"}let s=await fetch(t,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!s.ok){if(401===s.status)throw Error("ไม่ได้รับอนุญาต กรุณาเข้าสู่ระบบใหม่");throw Error("HTTP error! status: ".concat(s.status))}let a=await s.json();if(!a.success)throw Error(a.error||"Failed to fetch data");let r=[];"week"===e&&a.data.weeklyData?r=a.data.weeklyData.map(e=>({period:b[e.day]||e.day,approved:e.approved,rejected:e.rejected})):"month"===e&&a.data.monthlyData?r=a.data.monthlyData.map(e=>({period:z[e.month]||e.month,approved:e.approved,rejected:e.rejected})):"year"===e&&a.data.yearlyData&&(r=a.data.yearlyData.map(e=>({period:e.year.toString(),approved:e.approved,rejected:e.rejected}))),n(r),j(!1)}catch(t){console.error("Error fetching data:",t),f(t instanceof Error?t.message:"Unknown error occurred"),n(E(e)),j(!0)}finally{h(!1)}},[b,z]),E=e=>{switch(e){case"week":return[{period:"จันทร์",approved:12,rejected:3},{period:"อังคาร",approved:18,rejected:2},{period:"พุธ",approved:15,rejected:4},{period:"พฤหัสบดี",approved:22,rejected:1},{period:"ศุกร์",approved:28,rejected:5},{period:"เสาร์",approved:35,rejected:3},{period:"อาทิตย์",approved:31,rejected:2}];case"month":return[{period:"ม.ค.",approved:245,rejected:15},{period:"ก.พ.",approved:198,rejected:12},{period:"มี.ค.",approved:267,rejected:18},{period:"เม.ย.",approved:223,rejected:14},{period:"พ.ค.",approved:289,rejected:21},{period:"มิ.ย.",approved:234,rejected:16},{period:"ก.ค.",approved:312,rejected:19},{period:"ส.ค.",approved:278,rejected:17},{period:"ก.ย.",approved:256,rejected:13},{period:"ต.ค.",approved:298,rejected:22},{period:"พ.ย.",approved:267,rejected:18},{period:"ธ.ค.",approved:334,rejected:25}];case"year":return[{period:"2020",approved:2890,rejected:145},{period:"2021",approved:3245,rejected:178},{period:"2022",approved:3567,rejected:203},{period:"2023",approved:3891,rejected:234},{period:"2024",approved:4123,rejected:267}];default:return[]}};(0,r.useEffect)(()=>{T(e)},[e,T]);let L=s.reduce((e,t)=>e+t.approved,0),R=s.reduce((e,t)=>e+t.rejected,0);return(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(l.ZB,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-5 w-5 text-blue-500"}),(0,a.jsx)("span",{className:"text-base sm:text-lg",children:"สถิติผู้มาเยือน"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 self-start sm:self-auto",children:[(0,a.jsx)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"ช่วงเวลา:"}),(0,a.jsxs)(i.l6,{value:e,onValueChange:e=>{t(e)},children:[(0,a.jsx)(i.bq,{className:"w-24 sm:w-32 text-xs sm:text-sm",children:(0,a.jsx)(i.yv,{})}),(0,a.jsxs)(i.gC,{children:[(0,a.jsx)(i.eb,{value:"week",children:"สัปดาห์"}),(0,a.jsx)(i.eb,{value:"month",children:"เดือน"}),(0,a.jsx)(i.eb,{value:"year",children:"ปี"})]})]})]})]}),(0,a.jsxs)(l.BT,{className:"flex flex-col gap-1 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs sm:text-sm",children:[(0,a.jsx)(A.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(()=>{let t=new Date;switch(e){case"week":default:return"สัปดาห์ที่ ".concat(t.getDate()-6," - ").concat(t.getDate()," ").concat(t.toLocaleDateString("th-TH",{month:"long",year:"numeric"}));case"month":return"ข้อมูลรายเดือน ปี ".concat(t.getFullYear());case"year":return"ข้อมูลรายปี ".concat(t.getFullYear()-4," - ").concat(t.getFullYear())}})()]}),g&&(0,a.jsx)("div",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded",children:"⚠️ แสดงข้อมูลจำลอง (ไม่สามารถเชื่อมต่อ API ได้)"})]})]}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 pt-4",children:u?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"กำลังโหลดข้อมูล..."})]}):p?(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-red-600",children:["เกิดข้อผิดพลาด: ",p]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-600 rounded-full"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:["อนุมัติ: ",L.toLocaleString()," คน"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-red-600 rounded-full"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:["ปฏิเสธ: ",R.toLocaleString()," คน"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-purple-600 rounded-full"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:["รวม: ",(L+R).toLocaleString()," คน"]})]})]}),(0,a.jsx)(d.E,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200 text-xs sm:text-sm w-fit",children:(()=>{let t=L+R,a=s.length;if(0===a)return"ไม่มีข้อมูล";let r=Math.round(t/a);switch(e){case"week":default:return"เฉลี่ย: ".concat(r," คน/วัน");case"month":return"เฉลี่ย: ".concat(r," คน/เดือน");case"year":return"เฉลี่ย: ".concat(r.toLocaleString()," คน/ปี")}})()})]})})]}),(0,a.jsx)(l.Wu,{children:u?(0,a.jsx)("div",{className:"h-[250px] sm:h-[300px] lg:h-[350px] w-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-8 w-8 animate-spin text-blue-500"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"กำลังโหลดข้อมูล..."})]})}):p?(0,a.jsx)("div",{className:"h-[250px] sm:h-[300px] lg:h-[350px] w-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,a.jsx)("span",{className:"text-sm text-red-600",children:"เกิดข้อผิดพลาดในการโหลดข้อมูล"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:p}),(0,a.jsx)("button",{onClick:()=>T(e),className:"mt-2 px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600",children:"ลองใหม่"})]})}):0===s.length?(0,a.jsx)("div",{className:"h-[250px] sm:h-[300px] lg:h-[350px] w-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"ไม่มีข้อมูลในช่วงเวลานี้"})}):(0,a.jsx)(v,{config:S,className:"h-[250px] sm:h-[300px] lg:h-[350px] w-full",children:(0,a.jsxs)(o.E,{accessibilityLayer:!0,data:s,children:[(0,a.jsx)(c.d,{vertical:!1,strokeDasharray:"3 3"}),(0,a.jsx)(x.W,{dataKey:"period",tickLine:!1,tickMargin:10,axisLine:!1,tickFormatter:t=>{switch(e){case"week":default:return t.slice(0,3);case"month":case"year":return t}},fontSize:10}),(0,a.jsx)(N,{content:(0,a.jsx)(w,{})}),(0,a.jsx)(y,{content:(0,a.jsx)(k,{})}),(0,a.jsx)(m.y,{dataKey:"approved",fill:"var(--color-approved)",radius:[4,4,0,0]}),(0,a.jsx)(m.y,{dataKey:"rejected",fill:"var(--color-rejected)",radius:[4,4,0,0]})]})})})]})}var T=s(30285),E=s(85127),L=s(12318),R=s(47924),P=s(381),F=s(42355),D=s(13052),O=s(54165),Z=s(17649);function U(e){let{...t}=e;return(0,a.jsx)(Z.bL,{"data-slot":"alert-dialog",...t})}function M(e){let{...t}=e;return(0,a.jsx)(Z.ZL,{"data-slot":"alert-dialog-portal",...t})}function H(e){let{className:t,...s}=e;return(0,a.jsx)(Z.hJ,{"data-slot":"alert-dialog-overlay",className:(0,f.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function I(e){let{className:t,...s}=e;return(0,a.jsxs)(M,{children:[(0,a.jsx)(H,{}),(0,a.jsx)(Z.UC,{"data-slot":"alert-dialog-content",className:(0,f.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s})]})}function B(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,f.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function W(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,f.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function q(e){let{className:t,...s}=e;return(0,a.jsx)(Z.hE,{"data-slot":"alert-dialog-title",className:(0,f.cn)("text-lg font-semibold",t),...s})}function $(e){let{className:t,...s}=e;return(0,a.jsx)(Z.VY,{"data-slot":"alert-dialog-description",className:(0,f.cn)("text-muted-foreground text-sm",t),...s})}function J(e){let{className:t,...s}=e;return(0,a.jsx)(Z.rc,{className:(0,f.cn)((0,T.r)(),t),...s})}function V(e){let{className:t,...s}=e;return(0,a.jsx)(Z.ZD,{className:(0,f.cn)((0,T.r)({variant:"outline"}),t),...s})}var G=s(62523),X=s(88539),Y=s(55670),K=s(54416),Q=s(5196);function ee(e){let{user:t,isOpen:s,onClose:n,onSubmit:l}=e,[d,o]=(0,r.useState)({approvedRole:"",houseNumber:"",notes:""}),[c,x]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&o({approvedRole:"resident"===t.role?"ลูกบ้าน":"ยาม",houseNumber:"-"!==t.houseNumber?t.houseNumber:"",notes:""})},[t]);let h=()=>{x(!1),u(!1)};return t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O.lG,{open:s,onOpenChange:n,children:(0,a.jsxs)(O.Cf,{className:"sm:max-w-lg max-w-[95vw] max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(O.c7,{children:(0,a.jsxs)(O.L3,{className:"text-xl font-semibold flex items-center gap-2",children:[(0,a.jsx)(Y.A,{className:"h-5 w-5 text-blue-500"}),"อนุมัติผู้ใช้ใหม่"]})}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-6 border border-blue-200",children:[(0,a.jsx)("h3",{className:"font-medium text-blue-900 mb-3",children:"ข้อมูลผู้สมัคร"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-700 font-medium",children:"ชื่อ-นามสกุล:"}),(0,a.jsxs)("p",{className:"text-blue-900",children:[t.fname," ",t.lname]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-700 font-medium",children:"Username:"}),(0,a.jsxs)("p",{className:"text-blue-900",children:["@",t.username]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-700 font-medium",children:"อีเมล:"}),(0,a.jsx)("p",{className:"text-blue-900",children:t.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-700 font-medium",children:"เบอร์โทร:"}),(0,a.jsx)("p",{className:"text-blue-900",children:t.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-700 font-medium",children:"วันที่สมัคร:"}),(0,a.jsx)("p",{className:"text-blue-900",children:new Date(t.requestDate).toLocaleDateString("th-TH")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-700 font-medium",children:"บทบาทที่สมัคร:"}),(0,a.jsx)("p",{className:"text-blue-900",children:"resident"===t.role?"ลูกบ้าน":"ยาม"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"บทบาทที่อนุมัติ"}),(0,a.jsxs)(i.l6,{value:d.approvedRole,onValueChange:e=>o({...d,approvedRole:e}),children:[(0,a.jsx)(i.bq,{children:(0,a.jsx)(i.yv,{placeholder:"เลือกบทบาท"})}),(0,a.jsxs)(i.gC,{children:[(0,a.jsx)(i.eb,{value:"ลูกบ้าน",children:"ลูกบ้าน"}),(0,a.jsx)(i.eb,{value:"ยาม",children:"ยาม"})]})]})]}),"ลูกบ้าน"===d.approvedRole&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"บ้านเลขที่"}),(0,a.jsx)(G.p,{placeholder:"เช่น 88/123",value:d.houseNumber,onChange:e=>o({...d,houseNumber:e.target.value})}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"กรอกบ้านเลขที่สำหรับลูกบ้าน"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"หมายเหตุ (ไม่บังคับ)"}),(0,a.jsx)(X.T,{placeholder:"เพิ่มหมายเหตุหรือข้อมูลเพิ่มเติม...",value:d.notes,onChange:e=>o({...d,notes:e.target.value}),rows:3})]})]}),(0,a.jsxs)(O.Es,{className:"flex gap-3 pt-6",children:[(0,a.jsxs)(T.$,{type:"button",variant:"outline",className:"flex-1 border-red-300 text-red-700 hover:bg-red-50",onClick:()=>{t&&u(!0)},children:[(0,a.jsx)(K.A,{className:"w-4 h-4 mr-2"}),"ปฏิเสธ"]}),(0,a.jsxs)(T.$,{type:"button",className:"flex-1 bg-green-600 hover:bg-green-700 text-white",onClick:()=>{if(t){if("ลูกบ้าน"===d.approvedRole&&!d.houseNumber.trim())return void alert("กรุณาระบุบ้านเลขที่สำหรับลูกบ้าน");x(!0)}},children:[(0,a.jsx)(Q.A,{className:"w-4 h-4 mr-2"}),"อนุมัติ"]})]})]})}),(0,a.jsx)(U,{open:c,onOpenChange:x,children:(0,a.jsxs)(I,{className:"flex flex-col w-100",children:[(0,a.jsxs)(B,{children:[(0,a.jsxs)(q,{className:"flex items-center gap-2",children:[(0,a.jsx)(Q.A,{className:"h-5 w-5 text-green-600"}),"ยืนยันการอนุมัติ"]}),(0,a.jsxs)($,{children:["คุณต้องการอนุมัติผู้ใช้ ",(0,a.jsxs)("strong",{children:[null==t?void 0:t.fname," ",null==t?void 0:t.lname]}),"เป็น ",(0,a.jsx)("strong",{children:d.approvedRole})," ใช่หรือไม่?","ลูกบ้าน"===d.approvedRole&&d.houseNumber&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("br",{}),"บ้านเลขที่: ",(0,a.jsx)("strong",{children:d.houseNumber})]})]})]}),(0,a.jsxs)(W,{children:[(0,a.jsx)(V,{onClick:h,children:"ยกเลิก"}),(0,a.jsx)(J,{onClick:()=>{x(!1),l("approve",d)},className:"bg-green-600 hover:bg-green-700",children:"ยืนยันการอนุมัติ"})]})]})}),(0,a.jsx)(U,{open:m,onOpenChange:u,children:(0,a.jsxs)(I,{className:"flex flex-col w-100",children:[(0,a.jsxs)(B,{children:[(0,a.jsxs)(q,{className:"flex items-center gap-2",children:[(0,a.jsx)(K.A,{className:"h-5 w-5 text-red-600"}),"ยืนยันการปฏิเสธ"]}),(0,a.jsxs)($,{children:["คุณต้องการปฏิเสธผู้ใช้ ",(0,a.jsxs)("strong",{children:[null==t?void 0:t.fname," ",null==t?void 0:t.lname]})," ใช่หรือไม่?",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-red-600 font-medium",children:"การปฏิเสธจะทำให้ผู้ใช้ไม่สามารถเข้าสู่ระบบได้"})]})]}),(0,a.jsxs)(W,{children:[(0,a.jsx)(V,{onClick:h,children:"ยกเลิก"}),(0,a.jsx)(J,{onClick:()=>{u(!1),l("reject",d)},className:"bg-red-600 hover:bg-red-700",children:"ยืนยันการปฏิเสธ"})]})]})})]}):null}function et(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[c,x]=(0,r.useState)(null),[m,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)(1),[j,v]=(0,r.useState)(()=>{if(window.localStorage){let e=localStorage.getItem("pendingTable_itemsPerPage");return e?parseInt(e,10):2}return 2}),[b,N]=(0,r.useState)(""),[w,y]=(0,r.useState)(!1),k=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?y(!0):o(!0),x(null);let s=await fetch("/api/pendingUsers");if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));let a=await s.json();if(a.success)t(a.data.residents),n(a.data.guards);else throw Error(a.error||"Failed to fetch pending users")}catch(e){x(e instanceof Error?e.message:"An error occurred"),console.error("Error fetching pending users:",e)}finally{o(!1),y(!1)}};(0,r.useEffect)(()=>{k()},[]);let C=async(e,t)=>{if(m){console.log("".concat(e," user:"),m.id,"with data:",t);try{let s;s="approve"===e?await fetch("/api/approveUser",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:m.id,currentRole:m.role,approvedRole:"ลูกบ้าน"===t.approvedRole?"resident":"guard",houseNumber:"ลูกบ้าน"===t.approvedRole?t.houseNumber:void 0,notes:t.notes})}):await fetch("/api/rejectUser",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:m.id,currentRole:m.role,reason:"Rejected by administrator",notes:t.notes})});let a=await s.json();a.success?(console.log("User ".concat(e,"d successfully:"),a.message),await k(!0),p(!1),u(null)):(console.error("Failed to ".concat(e," user:"),a.error),alert("Failed to ".concat(e," user: ").concat(a.error)))}catch(t){console.error("Error ".concat(e,"ing user:"),t),alert("An error occurred while ".concat(e,"ing the user"))}}},A=e=>({id:e.id,username:e.email.split("@")[0],email:e.email,fname:e.fname,lname:e.lname,phone:e.phone,role:e.role,houseNumber:e.house_address||"-",requestDate:e.createdAt,status:e.status,profile_image_url:e.profile_image_url}),_=[...e.map(A),...s.map(A)],S=_.filter(e=>e.fname.toLowerCase().includes(b.toLowerCase())||e.lname.toLowerCase().includes(b.toLowerCase())||e.email.toLowerCase().includes(b.toLowerCase())||e.status.toLowerCase().includes(b.toLowerCase())||e.houseNumber.includes(b)),z=S.length,O=Math.ceil(z/j),Z=(f-1)*j,U=Z+j,M=S.slice(Z,U);return((0,r.useEffect)(()=>{g(1)},[b]),l)?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-muted-foreground",children:"กำลังโหลดข้อมูล..."})]})}):c?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-red-500 text-xl mb-2",children:"⚠️"}),(0,a.jsxs)("p",{className:"text-red-600",children:["เกิดข้อผิดพลาด: ",c]}),(0,a.jsx)("button",{onClick:()=>k(),className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"ลองใหม่"})]})}):(0,a.jsxs)("div",{className:"bg-background rounded-lg shadow-sm border",children:[(0,a.jsx)("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(L.A,{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-500"}),(0,a.jsx)("h2",{className:"text-lg sm:text-xl font-semibold text-foreground",children:"ผู้ใช้ใหม่รออนุมัติ"}),(0,a.jsxs)(d.E,{variant:"secondary",className:"bg-orange-100 text-orange-800 text-xs sm:text-sm",children:[_.length," รายการ"]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4",children:[(0,a.jsxs)("div",{className:"relative w-full sm:w-auto",children:[(0,a.jsx)(R.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"ค้นหาผู้ใช้...",value:b,onChange:e=>N(e.target.value),className:"pl-10 pr-4 py-2 border border-border rounded-lg focus:ring-2 focus:ring-ring focus:border-transparent w-full sm:w-64 text-sm"})]}),(0,a.jsx)("div",{className:"text-xs sm:text-sm text-muted-foreground flex items-center gap-2",children:w&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-blue-600",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),(0,a.jsx)("span",{children:"กำลังอัปเดต..."})]})})]})]})}),(0,a.jsx)("div",{className:"overflow-x-auto rounded-lg border border-border bg-background shadow-sm hover:shadow-md transition-shadow duration-200",children:(0,a.jsxs)(E.XI,{children:[(0,a.jsx)(E.A0,{children:(0,a.jsxs)(E.Hj,{className:"bg-muted/50 border-b border-border",children:[(0,a.jsx)(E.nd,{className:"text-muted-foreground font-semibold text-sm py-4 px-6",children:"ผู้สมัคร"}),(0,a.jsx)(E.nd,{className:"text-muted-foreground font-semibold text-sm py-4 px-6 hidden sm:table-cell",children:"ข้อมูลติดต่อ"}),(0,a.jsx)(E.nd,{className:"text-muted-foreground font-semibold text-sm py-4 px-6",children:"บทบาท"}),(0,a.jsx)(E.nd,{className:"text-muted-foreground font-semibold text-sm py-4 px-6 hidden md:table-cell",children:"บ้านเลขที่"}),(0,a.jsx)(E.nd,{className:"text-muted-foreground font-semibold text-sm py-4 px-6 hidden lg:table-cell",children:"วันที่สมัคร"}),(0,a.jsx)(E.nd,{className:"text-muted-foreground font-semibold text-sm py-4 px-6",children:"การดำเนินการ"})]})}),(0,a.jsx)(E.BF,{children:M.map(e=>{let t,s;return(0,a.jsxs)(E.Hj,{className:"hover:bg-muted/30 transition-colors border-b border-border/50",children:[(0,a.jsx)(E.nA,{className:"py-4 px-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-sm ".concat((e=>{let t=["bg-blue-500","bg-green-500","bg-purple-500","bg-yellow-500","bg-red-500","bg-indigo-500"],s=e.charCodeAt(0)%t.length;return t[s]})(e.id)),children:(t=e.fname,s=e.lname,"".concat(t.charAt(0)).concat(s.charAt(0)).toUpperCase())}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsxs)("div",{className:"font-semibold text-foreground text-base",children:[e.fname," ",e.lname]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["@",e.username]}),(0,a.jsxs)("div",{className:"sm:hidden text-xs text-muted-foreground mt-1 space-y-1",children:[(0,a.jsx)("div",{children:e.email}),(0,a.jsx)("div",{children:e.phone})]})]})]})}),(0,a.jsx)(E.nA,{className:"hidden sm:table-cell",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-sm text-foreground",children:e.email}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.phone})]})}),(0,a.jsx)(E.nA,{children:(0,a.jsx)(d.E,{variant:"outline",className:"text-xs sm:text-sm ".concat("guard"===e.role?"border-blue-200 text-blue-700 bg-blue-50":"border-green-200 text-green-700 bg-green-50"),children:"guard"===e.role?"ยาม":"ลูกบ้าน"})}),(0,a.jsx)(E.nA,{className:"text-gray-700 hidden md:table-cell text-sm",children:"-"!==e.houseNumber?e.houseNumber:"-"}),(0,a.jsx)(E.nA,{className:"text-muted-foreground hidden lg:table-cell text-sm",children:new Date(e.requestDate).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric"})}),(0,a.jsx)(E.nA,{children:(0,a.jsxs)(T.$,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs sm:text-sm",onClick:()=>{u(e),p(!0)},children:[(0,a.jsx)(P.A,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"ดำเนินการ"}),(0,a.jsx)("span",{className:"sm:hidden",children:"จัดการ"})]})})]},e.id)})})]})}),0===S.length&&(0,a.jsxs)("div",{className:"p-8 sm:p-12 text-center",children:[(0,a.jsx)(L.A,{className:"h-8 w-8 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-base sm:text-lg font-medium text-foreground mb-2",children:b?"ไม่พบข้อมูลที่ค้นหา":"ไม่มีผู้ใช้ใหม่รออนุมัติ"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:b?"ลองค้นหาด้วยคำอื่น":"ผู้ใช้ใหม่ที่สมัครเข้ามาจะปรากฏที่นี่"})]}),z>0&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 sm:px-6 py-4 border-t bg-muted gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"แสดง"}),(0,a.jsxs)(i.l6,{value:j.toString(),onValueChange:e=>{let t=Number(e);v(t),g(1),window.localStorage&&localStorage.setItem("pendingTable_itemsPerPage",t.toString())},children:[(0,a.jsx)(i.bq,{className:"w-16 sm:w-20 text-xs sm:text-sm",children:(0,a.jsx)(i.yv,{})}),(0,a.jsxs)(i.gC,{children:[(0,a.jsx)(i.eb,{value:"2",children:"2"}),(0,a.jsx)(i.eb,{value:"3",children:"3"}),(0,a.jsx)(i.eb,{value:"5",children:"5"}),(0,a.jsx)(i.eb,{value:"10",children:"10"})]})]}),(0,a.jsx)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"รายการต่อหน้า"})]}),(0,a.jsxs)("div",{className:"text-xs sm:text-sm text-muted-foreground",children:["แสดง ",Z+1," ถึง ",Math.min(U,z)," จาก ",z," รายการ"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(T.$,{variant:"outline",size:"sm",onClick:()=>{f>1&&g(f-1)},disabled:1===f,className:"flex items-center text-xs sm:text-sm",children:[(0,a.jsx)(F.A,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"ก่อนหน้า"}),(0,a.jsx)("span",{className:"sm:hidden",children:"ก่อน"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(O,5)},(e,t)=>{let s;return s=O<=5||f<=3?t+1:f>=O-2?O-4+t:f-2+t,(0,a.jsx)(T.$,{variant:f===s?"default":"outline",size:"sm",onClick:()=>g(s),className:"w-6 h-6 sm:w-8 sm:h-8 p-0 text-xs sm:text-sm ".concat(f===s?"bg-blue-600 text-white":"text-muted-foreground hover:bg-gray-100"),children:s},s)})}),(0,a.jsxs)(T.$,{variant:"outline",size:"sm",onClick:()=>{f<O&&g(f+1)},disabled:f===O,className:"flex items-center text-xs sm:text-sm",children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:"ถัดไป"}),(0,a.jsx)("span",{className:"sm:hidden",children:"ถัด"}),(0,a.jsx)(D.A,{className:"w-3 h-3 sm:w-4 sm:h-4 ml-1"})]})]})]}),(0,a.jsx)(ee,{user:m,isOpen:h,onClose:()=>{p(!1),u(null)},onSubmit:C})]})}var es=s(40646),ea=s(54861),er=s(1243),en=s(84616),el=s(75525);function ed(e){var t;let{data:s,loading:r,error:n}=e;return(0,a.jsxs)(l.Zp,{className:"shadow transition-shadow hover:shadow-md",children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ZB,{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"จำนวนผู้อยู่อาศัยทั้งหมด"}),(0,a.jsx)(C.A,{className:"h-4 w-4 sm:h-6 sm:w-6 text-blue-500"})]}),(0,a.jsx)(l.Wu,{children:r?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"กำลังโหลด..."})]}):n?(0,a.jsx)("div",{className:"text-sm text-red-500",children:"เกิดข้อผิดพลาด"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:(null==s||null==(t=s.residentCount)?void 0:t.toLocaleString())||0}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)(C.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-blue-500 mr-1"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-blue-600 font-medium",children:["รออนุมัติ: ",(null==s?void 0:s.residentPendingCount)||0]})]})]})})]})}function ei(e){let{data:t,loading:s,error:r}=e;return(0,a.jsxs)(l.Zp,{className:"shadow transition-shadow hover:shadow-md",children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ZB,{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"ผู้มาเยือนวันนี้"}),(0,a.jsx)(Y.A,{className:"h-4 w-4 sm:h-6 sm:w-6 text-cyan-500"})]}),(0,a.jsx)(l.Wu,{children:s?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"กำลังโหลด..."})]}):r?(0,a.jsx)("div",{className:"text-sm text-red-500",children:"เกิดข้อผิดพลาด"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:((null==t?void 0:t.visitorApprovedToday)||0)+((null==t?void 0:t.visitorRejectedToday)||0)}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(es.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500 mr-1"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-green-600 font-medium",children:["อนุมัติ: ",(null==t?void 0:t.visitorApprovedToday)||0]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(ea.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-red-500 mr-1"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-red-600 font-medium",children:["ปฏิเสธ: ",(null==t?void 0:t.visitorRejectedToday)||0]})]})]})]})})]})}function eo(e){let{data:t,loading:s,error:r}=e;return(0,a.jsxs)(l.Zp,{className:"shadow transition-shadow hover:shadow-md",children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ZB,{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"ผู้มาเยือนรอดำเนินการ"}),(0,a.jsx)(er.A,{className:"h-4 w-4 sm:h-6 sm:w-6 text-orange-500"})]}),(0,a.jsx)(l.Wu,{children:s?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"กำลังโหลด..."})]}):r?(0,a.jsx)("div",{className:"text-sm text-red-500",children:"เกิดข้อผิดพลาด"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:(null==t?void 0:t.visitorPendingToday)||0}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)(er.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-orange-500 mr-1"}),(0,a.jsx)("span",{className:"text-xs sm:text-sm text-orange-600 font-medium",children:"รอการอนุมัติวันนี้"})]})]})})]})}function ec(e){let{data:t,loading:s,error:r}=e,n=((null==t?void 0:t.residentPendingCount)||0)+((null==t?void 0:t.guardPendingCount)||0);return(0,a.jsxs)(l.Zp,{className:"shadow transition-shadow hover:shadow-md",children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ZB,{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"ผู้ใช้รอการอนุมัติ"}),(0,a.jsx)(en.A,{className:"h-4 w-4 sm:h-6 sm:w-6 text-purple-500"})]}),(0,a.jsx)(l.Wu,{children:s?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"กำลังโหลด..."})]}):r?(0,a.jsx)("div",{className:"text-sm text-red-500",children:"เกิดข้อผิดพลาด"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:n}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(C.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-blue-500 mr-1"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-blue-600 font-medium",children:["ผู้อยู่อาศัย: ",(null==t?void 0:t.residentPendingCount)||0]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(el.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-cyan-500 mr-1"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-cyan-600 font-medium",children:["ยาม: ",(null==t?void 0:t.guardPendingCount)||0]})]})]})]})})]})}function ex(){let[e,t]=(0,r.useState)(null),{data:s,loading:l,error:d}=function(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0),[n,l]=(0,r.useState)(null),d=async()=>{a(!0),l(null);try{let e=await fetch("/api/statsCard",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok){if(401===e.status)throw Error("ไม่ได้รับอนุญาต กรุณาเข้าสู่ระบบใหม่");throw Error("HTTP error! status: ".concat(e.status))}let s=await e.json();if(!s.success)throw Error(s.error||"Failed to fetch stats");t(s.data)}catch(e){console.error("Error fetching stats:",e),l(e instanceof Error?e.message:"Unknown error occurred"),t({residentCount:1247,residentPendingCount:12,guardPendingCount:3,visitorRecordToday:45,visitorApprovedToday:38,visitorPendingToday:5,visitorRejectedToday:2})}finally{a(!1)}};return(0,r.useEffect)(()=>{d()},[]),{data:e,loading:s,error:n,refetch:d}}(),i=(0,r.useRef)(null),o=(0,r.useRef)(null),c=(0,r.useRef)(null);return(0,r.useEffect)(()=>{fetch("/api/auth/me",{credentials:"include"}).then(e=>{if(401===e.status){window.location.href="/login";return}return e.json()}).then(e=>{e&&t(e)})},[]),(0,r.useEffect)(()=>{var t;if(!e)return;let s=o.current,a=c.current;n.os.set([s,a],{opacity:0,y:50});let r=null==(t=i.current)?void 0:t.children;r&&n.os.set(Array.from(r),{opacity:0,y:60});let l=n.os.timeline();return r&&Array.from(r).forEach((e,t)=>{l.to(e,{duration:.6,opacity:1,y:0,ease:"power2.inOut"},.1*t)}),l.to(s,{duration:.8,opacity:1,y:0,ease:"power2.inOut"},"-=0.2").to(a,{duration:.8,opacity:1,y:0,ease:"power2.inOut"},"-=0.4"),()=>{n.os.killTweensOf([s,a]),r&&n.os.killTweensOf(Array.from(r))}},[e]),(0,a.jsx)("div",{className:"min-h-screen bg-background",children:(0,a.jsxs)("div",{className:"container mx-auto px-2 sm:px-4 lg:px-6 py-3 sm:py-6 max-w-full xl:max-w-7xl",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4 sm:mb-6 lg:mb-8",children:[(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)("h1",{className:"scroll-m-20 text-lg sm:text-xl md:text-2xl lg:text-3xl font-semibold tracking-tight text-foreground"})}),(0,a.jsx)("div",{className:"flex justify-start sm:justify-end"})]}),(0,a.jsxs)("div",{ref:i,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-4 sm:mb-6 lg:mb-8",children:[(0,a.jsx)(ed,{data:s,loading:l,error:d}),(0,a.jsx)(ei,{data:s,loading:l,error:d}),(0,a.jsx)(eo,{data:s,loading:l,error:d}),(0,a.jsx)(ec,{data:s,loading:l,error:d})]}),(0,a.jsx)("div",{ref:o,className:"mb-4 sm:mb-6 lg:mb-8",children:(0,a.jsx)(z,{})}),(0,a.jsx)("div",{ref:c,className:"mb-4 sm:mb-6",children:(0,a.jsx)(et,{})})]})})}},85127:(e,t,s)=>{"use strict";s.d(t,{A0:()=>l,BF:()=>d,Hj:()=>i,XI:()=>n,nA:()=>c,nd:()=>o});var a=s(95155);s(12115);var r=s(59434);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",t),...s})})}function l(e){let{className:t,...s}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}},88539:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var a=s(95155);s(12115);var r=s(59434);function n(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}}},e=>{e.O(0,[592,389,802,609,589,764,71,914,441,964,358],()=>e(e.s=7058)),_N_E=e.O()}]);