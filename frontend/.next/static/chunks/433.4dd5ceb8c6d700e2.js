"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[433],{26126:(e,t,r)=>{r.d(t,{E:()=>c});var a=r(95155);r(12115);var s=r(99708),n=r(74466),d=r(59434);let l=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:r,asChild:n=!1,...c}=e,i=n?s.DX:"span";return(0,a.jsx)(i,{"data-slot":"badge",className:(0,d.cn)(l({variant:r}),t),...c})}},59409:(e,t,r)=>{r.d(t,{bq:()=>p,eb:()=>x,gC:()=>u,l6:()=>i,yv:()=>o});var a=r(95155);r(12115);var s=r(50083),n=r(66474),d=r(5196),l=r(47863),c=r(59434);function i(e){let{...t}=e;return(0,a.jsx)(s.bL,{"data-slot":"select",...t})}function o(e){let{...t}=e;return(0,a.jsx)(s.WT,{"data-slot":"select-value",...t})}function p(e){let{className:t,size:r="default",children:d,...l}=e;return(0,a.jsxs)(s.l9,{"data-slot":"select-trigger","data-size":r,className:(0,c.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[d,(0,a.jsx)(s.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"size-4 opacity-50"})})]})}function u(e){let{className:t,children:r,position:n="popper",...d}=e;return(0,a.jsx)(s.ZL,{children:(0,a.jsxs)(s.UC,{"data-slot":"select-content",className:(0,c.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...d,children:[(0,a.jsx)(m,{}),(0,a.jsx)(s.LM,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),(0,a.jsx)(h,{})]})})}function x(e){let{className:t,children:r,...n}=e;return(0,a.jsxs)(s.q7,{"data-slot":"select-item",className:(0,c.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...n,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(s.VF,{children:(0,a.jsx)(d.A,{className:"size-4"})})}),(0,a.jsx)(s.p4,{children:r})]})}function m(e){let{className:t,...r}=e;return(0,a.jsx)(s.PP,{"data-slot":"select-scroll-up-button",className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(l.A,{className:"size-4"})})}function h(e){let{className:t,...r}=e;return(0,a.jsx)(s.wn,{"data-slot":"select-scroll-down-button",className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(n.A,{className:"size-4"})})}},90433:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var a=r(95155),s=r(12115),n=r(66695),d=r(26126),l=r(59409),c=r(61900),i=r(94754),o=r(96025),p=r(17398),u=r(83540),x=r(94517),m=r(24026),h=r(59434);let f={light:"",dark:".dark"},v=s.createContext(null);function j(e){let{id:t,className:r,children:n,config:d,...l}=e,c=s.useId(),i="chart-".concat(t||c.replace(/:/g,""));return(0,a.jsx)(v.Provider,{value:{config:d},children:(0,a.jsxs)("div",{"data-slot":"chart","data-chart":i,className:(0,h.cn)("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",r),...l,children:[(0,a.jsx)(g,{id:i,config:d}),(0,a.jsx)(u.u,{children:n})]})})}let g=e=>{let{id:t,config:r}=e,s=Object.entries(r).filter(e=>{let[,t]=e;return t.theme||t.color});return s.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(f).map(e=>{let[r,a]=e;return"\n".concat(a," [data-chart=").concat(t,"] {\n").concat(s.map(e=>{var t;let[a,s]=e,n=(null==(t=s.theme)?void 0:t[r])||s.color;return n?"  --color-".concat(a,": ").concat(n,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},b=x.m;function y(e){let{active:t,payload:r,className:s,indicator:n="dot",...d}=e;return(0,a.jsx)("div",{})}let w=m.s;function N(e){let{className:t,hideIcon:r=!1,payload:s,...n}=e;return(0,a.jsx)("div",{})}var k=r(17580),_=r(69074),z=r(51154);let S={approved:{label:"อนุมัติ",color:"hsl(142, 76%, 36%)"},rejected:{label:"ปฏิเสธ",color:"hsl(0, 84%, 60%)"}},D=(0,s.memo)(function(){let[e,t]=(0,s.useState)("week"),[r,u]=(0,s.useState)([]),[x,m]=(0,s.useState)(!0),[h,f]=(0,s.useState)(null),[v,g]=(0,s.useState)(!1),D=(0,s.useMemo)(()=>({Sunday:"อาทิตย์",Monday:"จันทร์",Tuesday:"อังคาร",Wednesday:"พุธ",Thursday:"พฤหัสบดี",Friday:"ศุกร์",Saturday:"เสาร์"}),[]),L=(0,s.useMemo)(()=>({January:"ม.ค.",February:"ก.พ.",March:"มี.ค.",April:"เม.ย.",May:"พ.ค.",June:"มิ.ย.",July:"ก.ค.",August:"ส.ค.",September:"ก.ย.",October:"ต.ค.",November:"พ.ย.",December:"ธ.ค."}),[]),A=(0,s.useCallback)(async e=>{m(!0),f(null);try{let t="";switch(e){case"week":default:t="/api/visitor-record-weekly";break;case"month":t="/api/visitor-record-monthly";break;case"year":t="/api/visitor-record-yearly"}let r=await fetch(t,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!r.ok){if(401===r.status)throw Error("ไม่ได้รับอนุญาต กรุณาเข้าสู่ระบบใหม่");throw Error("HTTP error! status: ".concat(r.status))}let a=await r.json();if(!a.success)throw Error(a.error||"Failed to fetch data");let s=[];"week"===e&&a.data.weeklyData?s=a.data.weeklyData.map(e=>({period:D[e.day]||e.day,approved:e.approved,rejected:e.rejected})):"month"===e&&a.data.monthlyData?s=a.data.monthlyData.map(e=>({period:L[e.month]||e.month,approved:e.approved,rejected:e.rejected})):"year"===e&&a.data.yearlyData&&(s=a.data.yearlyData.map(e=>({period:e.year.toString(),approved:e.approved,rejected:e.rejected}))),u(s),g(!1)}catch(t){f(t instanceof Error?t.message:"Unknown error occurred"),u(C(e)),g(!0)}finally{m(!1)}},[D,L]),C=e=>{switch(e){case"week":return[{period:"จันทร์",approved:12,rejected:3},{period:"อังคาร",approved:18,rejected:2},{period:"พุธ",approved:15,rejected:4},{period:"พฤหัสบดี",approved:22,rejected:1},{period:"ศุกร์",approved:28,rejected:5},{period:"เสาร์",approved:35,rejected:3},{period:"อาทิตย์",approved:31,rejected:2}];case"month":return[{period:"ม.ค.",approved:245,rejected:15},{period:"ก.พ.",approved:198,rejected:12},{period:"มี.ค.",approved:267,rejected:18},{period:"เม.ย.",approved:223,rejected:14},{period:"พ.ค.",approved:289,rejected:21},{period:"มิ.ย.",approved:234,rejected:16},{period:"ก.ค.",approved:312,rejected:19},{period:"ส.ค.",approved:278,rejected:17},{period:"ก.ย.",approved:256,rejected:13},{period:"ต.ค.",approved:298,rejected:22},{period:"พ.ย.",approved:267,rejected:18},{period:"ธ.ค.",approved:334,rejected:25}];case"year":return[{period:"2020",approved:2890,rejected:145},{period:"2021",approved:3245,rejected:178},{period:"2022",approved:3567,rejected:203},{period:"2023",approved:3891,rejected:234},{period:"2024",approved:4123,rejected:267}];default:return[]}};(0,s.useEffect)(()=>{A(e)},[e,A]);let E=r.reduce((e,t)=>e+t.approved,0),F=r.reduce((e,t)=>e+t.rejected,0);return(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(n.ZB,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(k.A,{className:"h-5 w-5 text-blue-500"}),(0,a.jsx)("span",{className:"text-base sm:text-lg",children:"สถิติผู้มาเยือน"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 self-start sm:self-auto",children:[(0,a.jsx)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"ช่วงเวลา:"}),(0,a.jsxs)(l.l6,{value:e,onValueChange:e=>{t(e)},children:[(0,a.jsx)(l.bq,{className:"w-24 sm:w-32 text-xs sm:text-sm",children:(0,a.jsx)(l.yv,{})}),(0,a.jsxs)(l.gC,{children:[(0,a.jsx)(l.eb,{value:"week",children:"สัปดาห์"}),(0,a.jsx)(l.eb,{value:"month",children:"เดือน"}),(0,a.jsx)(l.eb,{value:"year",children:"ปี"})]})]})]})]}),(0,a.jsxs)(n.BT,{className:"flex flex-col gap-1 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs sm:text-sm",children:[(0,a.jsx)(_.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(()=>{let t=new Date;switch(e){case"week":default:return"สัปดาห์ที่ ".concat(t.getDate()-6," - ").concat(t.getDate()," ").concat(t.toLocaleDateString("th-TH",{month:"long",year:"numeric"}));case"month":return"ข้อมูลรายเดือน ปี ".concat(t.getFullYear());case"year":return"ข้อมูลรายปี ".concat(t.getFullYear()-4," - ").concat(t.getFullYear())}})()]}),v&&(0,a.jsx)("div",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded",children:"⚠️ แสดงข้อมูลจำลอง (ไม่สามารถเชื่อมต่อ API ได้)"})]})]}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 pt-4",children:x?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(z.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"กำลังโหลดข้อมูล..."})]}):h?(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-red-600",children:["เกิดข้อผิดพลาด: ",h]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-600 rounded-full"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:["อนุมัติ: ",E.toLocaleString()," คน"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-red-600 rounded-full"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:["ปฏิเสธ: ",F.toLocaleString()," คน"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-purple-600 rounded-full"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-muted-foreground",children:["รวม: ",(E+F).toLocaleString()," คน"]})]})]}),(0,a.jsx)(d.E,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200 text-xs sm:text-sm w-fit",children:(()=>{let t=E+F,a=r.length;if(0===a)return"ไม่มีข้อมูล";let s=Math.round(t/a);switch(e){case"week":default:return"เฉลี่ย: ".concat(s," คน/วัน");case"month":return"เฉลี่ย: ".concat(s," คน/เดือน");case"year":return"เฉลี่ย: ".concat(s.toLocaleString()," คน/ปี")}})()})]})})]}),(0,a.jsx)(n.Wu,{children:x?(0,a.jsx)("div",{className:"h-[250px] sm:h-[300px] lg:h-[350px] w-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(z.A,{className:"h-8 w-8 animate-spin text-blue-500"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"กำลังโหลดข้อมูล..."})]})}):h?(0,a.jsx)("div",{className:"h-[250px] sm:h-[300px] lg:h-[350px] w-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,a.jsx)("span",{className:"text-sm text-red-600",children:"เกิดข้อผิดพลาดในการโหลดข้อมูล"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:h}),(0,a.jsx)("button",{onClick:()=>A(e),className:"mt-2 px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600",children:"ลองใหม่"})]})}):0===r.length?(0,a.jsx)("div",{className:"h-[250px] sm:h-[300px] lg:h-[350px] w-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"ไม่มีข้อมูลในช่วงเวลานี้"})}):(0,a.jsx)(j,{config:S,className:"h-[250px] sm:h-[300px] lg:h-[350px] w-full",children:(0,a.jsxs)(c.E,{accessibilityLayer:!0,data:r,children:[(0,a.jsx)(i.d,{vertical:!1,strokeDasharray:"3 3"}),(0,a.jsx)(o.W,{dataKey:"period",tickLine:!1,tickMargin:10,axisLine:!1,tickFormatter:t=>{switch(e){case"week":default:return t.slice(0,3);case"month":case"year":return t}},fontSize:10}),(0,a.jsx)(b,{content:(0,a.jsx)(y,{})}),(0,a.jsx)(w,{content:(0,a.jsx)(N,{})}),(0,a.jsx)(p.y,{dataKey:"approved",fill:"var(--color-approved)",radius:[4,4,0,0]}),(0,a.jsx)(p.y,{dataKey:"rejected",fill:"var(--color-rejected)",radius:[4,4,0,0]})]})})})]})})}}]);